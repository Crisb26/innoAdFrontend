services:
  frontend:
    image: ${FRONTEND_IMAGE:-ghcr.io/your-org/innoad-frontend:latest}
    container_name: innoad-frontend
    ports:
      - "${FRONTEND_HTTP_PORT:-80}:80"
    depends_on:
      - backend
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "wget", "-qO-", "http://localhost/"]
      interval: 30s
      timeout: 5s
      retries: 3

  backend:
    image: ${BACKEND_IMAGE:-ghcr.io/your-org/innoad-backend:latest}
    container_name: innoad-backend
    environment:
      - SERVER_PORT=${BACKEND_INTERNAL_PORT:-8080}
      - SPRING_PROFILES_ACTIVE=${SPRING_PROFILES_ACTIVE:-prod}
      - INNOAD_JWT_SECRET=${JWT_SECRET:-change-me}
      - INNOAD_CORS_ALLOWED_ORIGINS=${CORS_ALLOWED_ORIGINS:-https://your-domain.com}
    expose:
      - "${BACKEND_INTERNAL_PORT:-8080}"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "wget", "-qO-", "http://localhost:${BACKEND_INTERNAL_PORT:-8080}/actuator/health"]
      interval: 30s
      timeout: 5s
      retries: 5

networks:
  default:
    name: innoad-net
